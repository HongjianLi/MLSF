#!/usr/bin/env Rscript
args=commandArgs(trailingOnly=T)
d=read.csv("iyp.csv")
n=nrow(d) # Number of samples.
xylim=c(0,14)
rmse=sqrt(sum((d["PredictedByCyscore"] - d["Measured"])^2)/n)
pcor=cor(d["PredictedByCyscore"], d["Measured"], method="pearson")
scor=cor(d["PredictedByCyscore"], d["Measured"], method="spearman")
setEPS()
postscript("iyp.eps")
#tiff("iyp.tiff",compression="lzw")
par(cex.lab=1.5,cex.axis=1.5,cex.main=1.5)
plot(d[,"Measured"], d[,"PredictedByCyscore"], xlim=xylim, ylim=xylim, xlab="Measured binding affinity", ylab="Predicted binding affinity by Cyscore", main=sprintf("N=%d, RMSE=%.2f, Rp=%.3f, Rs=%.3f", n, rmse, pcor, scor))
abline(a=0, b=1, lty=2)
grid()
